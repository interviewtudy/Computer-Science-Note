|                                                                                                                              **네트워크의 기초**                                                                                                                              |           **TCP/IP 4계층 모델**            |                                                                                                                                                                **네트워크 기기**                                                                                                                                                                |                                      **IP주소**                                       |                                                    **HTTP**                                                     |
| :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------: | :----------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------- |
| - [처리량과 지연 시간](#처리량과-지연-시간)<br>- [네트워크 토폴리지와 병목 현상](#네트워크-토폴리지와-병목-현상)<br>- [네트워크 분류](#네트워크-분류)<br>- [네트워크 성능 분석 명령어](#네트워크-성능-분석-명령어)<br>- [네트워크 프로토콜 표준화](#네트워크-프로토콜-표준화) | - [계층 구조](#계층-구조)<br>- [PDU](#pdu) | - [네트워크 기기의 처리 범위](#네트워크-기기의-처리-범위)<br>- [애플리케이션 계층을 처리하는 기기](#애플리케이션-계층을-처리하는-기기)<br>- [인터넷 계층을 처리하는 기기](#인터넷-계층을-처리하는-기기)<br>- [데이터 링크 계층을 처리하는 기기](#데이터-링크-계층을-처리하는-기기)<br>- [물리 계층을 처리하는 기기](#물리-계층을-처리하는-기기) | - [ARP](#arp)<br>- [홉바이홉 통신](#홉바이홉-통신)<br>- [IP 주소 체계](#ip-주소-체계) | - [HTTP/1.0](#http10)<br>- [HTTP/1.1](#http11)<br>- [HTTP/2](#http2)<br>- [HTTPS](#https)<br>- [HTTP/3](#http3) |

# 네트워크의 기초

### 네트워크 용어 정리

- 네트워크: 노드와 링크가 서로 연결되어 리소스를 공유하는 집합
- 노드: 서버, 라우터, 스위치 등 네트워크 장치
- 링크: 유선 또는 무선
- 트래픽: 특정 시점에 링크 내에 흐르는 데이터의 양
- 대역폭 : 주어진 시간 동안 네트워크 연결을 통해 흐를 수 있는 최대 비트 수

## 처리량과 지연 시간

네트워크 구축할 떄는 좋은 네트워크로 만드는 것이 중요하다

좋은 네트워크란 *많은 처리량을 처리*할 수 있으며 _지연 시간이 짧고_ 장애 빈도가 적으며 좋은 보안을 갖춘 네트워크를 의미

### 처리량

- 링크 내에서 성공적으로 전달된 데이터의 양, 보통 트래픽을 처리량을 나타냄
- 단위: bps (초당 전송, 수신되는 비트 수)

**영향을 주는 요소**
|사용자 트래픽|네트워크 장치 간의 대역폭|네트워크 중간에 발생하는 에러|장치의 하드웨어 스펙|

- 트래픽이 많아졌다 = 흐르는 데이터가 많다
- 처리량이 많아졌다 = 처리되는 트래픽이 많아졌다

### 지연 시간

- 요청이 처리되는 시간 (요청이 두 장치 사이를 왕복하는 데 걸린 시간)
  **영향을 주는 요소**
  |매체 타입(무선, 유선)|패킷 크기|라우터의 패킷 처리 시간|

## 네트워크 토폴리지와 병목 현상

### 네트워크 토폴로지

| 종류        | 설명                                                 | 장점                                                                                                               | 단점                                                                          |
| ----------- | ---------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------ | ----------------------------------------------------------------------------- |
| 트리/계층형 | 트리 형태로 배치한 네트워크 구성                     | 노드 추가, 삭제가 쉬움                                                                                             | 특정 노드에 트래픽이 집중될 때 하위 노드에 영향을 끼칠 수 있음                |
| 버스        | 중앙 통신 회선 하나에 여러 개의 노드가 연결되어 공유 | 근거리 통신망에서 사용                                                                                             | (별도 단점 내용이 없으므로 비워두거나 적절히 작성)                            |
| 스타        | 중앙에 있는 노드에 모두 연결됨                       | - **쉬운 노드 추가 & 에러 탐지**<br/>- **패킷 충돌 발생 가능성 낮음**<br/>- **에러 발생 시 다른 노드에 영향 적음** | - **중앙 노드 장애 시 전체 네트워크 사용 불가**<br/>- **설치 비용이 높음**    |
| 링형        | 전체적으로 고리처럼 양 옆의 노드가 연결되어 있음     | - **노드 수 증가 시 네트워크 손실 적음**<br/>- **충돌 발생 가능성 낮음**<br/>- **쉬운 고장 발견**                  | - **네트워크 구성 변경이 어려움**<br/>- **회선 장애 시 전체 네트워크에 영향** |

**스푸핑**
LAN상에서 송신부의 패킷을 송신과 관련 없는 다른 호스트에 가지 않도록 하는 스위칭 기능을 마비시키거나 속여서 특정 노드에 해당 패킷이 오도록 처리하는 것
스푸핑을 적용하면 올바르게 수신부로 가야 할 패킷이 악의적인 노드에 전달하게 됨

### 병목 현상

| 네트워크나 시스템에서 특정 구간이 과부하를 일으켜 전체 서비스의 성능이 저하되는 상황

네트워크의 구조(토폴로지)는 병목 현상을 찾을 때 중요한 기준이 된다

예를 들어, 서비스 이용자가 몰려 지연 시간이 길어졌을 때 대역폭만 늘려도 해결될 것 같지만, 실제로는 네트워크의 토폴로지나 회선 구성 등 다양한 요소가 원인일 수 있습니다.

따라서 네트워크가 어떤 구조로 연결되어 있는지, 각 구간마다 어느 정도의 트래픽을 처리하는지 파악해야 병목 구간을 정확히 찾아내고 적절한 방법(추가 회선 설치, 회선 경로 조정, 서버 간 연결 방식 변경 등)으로 성능을 개선할 수 있습니다.

## 네트워크 분류

네트워크는 규모를 기반으로 분류 가능함

**LAN** : 개인적으로 소유 가능한 규모
근거리 통신망을 의미하며 같은 건물이나 캠퍼스 같은 좁은 공간에서 운영
장점 - 전송 속도가 빠르고 혼잡하지 않음

**MAN** : 대도시 지역 네트워크를 나타내며 도시 같은 넓은 지역에서 운영
전송 속도는 평균이며 LAN보다는 더 많이 혼잡함

**WAN**
광역 네트워크를 의미하며 국가 또는 대륙 같은 더 넓은 지역에서 운영
전송 속도는 낮으며 MAN보다는 더 혼잡합니다.

## 네트워크 성능 분석 명령어

애플리케이션 코드상에는 전혀 문제가 없는데 사용자가 서비스로부터 데이터를 가져오지 못하는 상황이 발생되기도 하며, 이는 네트워크 병목 현상일 가능성이 있다.

**네트워크 병목 현상의 주된 원인**
|네트워크 대역폭|네트워크 토폴로지|서버 CPU, 메모리 사용량|비효율적인 네트워크 구성

이때는 네트워크 관련 테스트와 네트워크와 무관한 테스트를 통해 ‘네트워크로부터 발생한 문제점’인 것을 확인한 후 네트워크 성능 분석을 해봐야 합니다. 이때 사용되는 명령어

| 명령어   | 설명                                                                                                                                                                                                                |
| -------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Ping     | -네트워크 상태를 확인하기 위해 노드로 일정 크기의 패킷을 전송<br/>- 패킷 수신 상태, 응답 시간, 네트워크 연결 여부를 확인<br/>-ICMP 프로토콜을 기반으로 동작, 지원하지 않는 기기나 차단된 네트워크에서는 사용 불가능 |
| netstat  | -접속되어 있는 서비스들의 네트워크 상태를 표시하는 데 사용됨<br/>-네트워크 접속, 라우팅 테이블, 네트워크 프로토콜 등 리스트를 보여줌<br/>서비스의 포트가 열여 있는지 확일할 때 사용                                 |
| nslookup | DNS에 관련된 내용을 확인하기 위해 사용<br/>특정 도메인에 매핑된 IP을 확인하기 위해                                                                                                                                  |
| tracert  | 목적지 노드까지 네트워크 경로를 확인할 때 사용하는 명령어<br/>목적지 노드까지 구간 중 어디서 느려지는 지 확인 가능                                                                                                  |

## 네트워크 프로토콜 표준화

- 다른 장치들끼리 데이터를 주고받기 위해 설정된 공통된 인터페이스
- 기업이나 개인이 발표해서 정하는 것이 아니라 IEEE 또는 IETF라는 표준화 단체가 이를 정함

---

# TCP/IP 4계층 모델

인터넷 프로토콜 스위트: 인터넷에서 컴퓨터들이 서로 정보를 주고받는 데 쓰이는 프로토콜의 집합
ex) TCP/IP 4계층 모델, OSI 7계층

## 계층 구조

| TCP/IP 4계층                       | OSI 7계층    |
| ---------------------------------- | ------------ |
|                                    | 애플리케이션 |
| [애플리케이션](#애플리케이션-계층) | 프레젠테이션 |
|                                    | 세션         |
| [전송](#전송-계층)                 | 전송         |
| [인터넷](#인터넷-계층)             | 네트워크     |
| [링크](#링크-계층)                 | 데이터 링크  |
|                                    | 물리         |

### 애플리케이션 계층

- FTP, HTTP, SSH, SMTP, DNS 등 응용 프로그램이 사용됨
- 웹 서비스, 이메일 등 서비스를 실질적으로 사람들에게 제공하는 층

**FTP**: 장치와 장치 간의 파일을 전송하는 데 사용되는 표준 통신 프로토콜
**SSH**: 보안되지 않은 네트워크에서 네트워크 서비스를 안전하게 운영하기 위한 암호화 네트워크 프로토콜
**HTTP**: WWW를 위한 데이터 통신의 기초이자 웹 사이트를 이용하는 게 쓰는 프로토콜
**SMTP**: 전자 메일 전송을 위한 인터넷 표준 통신 프로토콜
**DNS**: 도메인 이름과 IP주소를 맵핑해주는 서버

### 전송 계층

- TCP, UDP
- 송신자와 수신자를 연결하는 통신 서비스를 제공
- 연결 지향 데이터 스트림 지원
- 신뢰성, 흐름 제어를 제공
- 애플리케이션과 인터켓 계층 사이의 데이터가 전달 중계 역할

| **TCP**                                                                                                                                              | **UDP** |
| ---------------------------------------------------------------------------------------------------------------------------------------------------- | ------- |
| - 패킷 사이의 순서를 보장 </br>- 연결지향 프로토콜을 사용해서 연결</br>- 신뢰성을 구축해서 수신 여부를 확인</br>- **가상회선 패킷 교환 방식**을 사용 |
| - 순서를 보장하지 않음 </br>-수신 여부를 확인하지 않음 </br>-단순히 데이터만 주는 **데이터그램 패킷 교환 방식**을 사용                               |

**가상 회선 패킷 교환 방식**
각 패킷에는 가상회선 식별자가 포함되어 모든 패킷을 전송하면 가상회선이 해제되고 패킷들은 전송된 ‘순서대로’ 도착하는 방식

**데이터그램 패킷 교환 방식**
데이터그램 패킷 교환 방식이란 패킷이 독립적으로 이동하며 최적의 경로를 선택하여 가는데, 하나의 메시지에서 분할된 여러 패킷은 서로 다른 경로로 전송될 수 있으며 도착한 순서가 다를 수 있는 방식

**TCP 연결 성립 과정**
신뢰성을 확보할 때 _3-way handshake_ 작업을 진행 (TCP)

클라이언트와 서버가 통신할 때 3단계의 과정 이후 신뢰성이 구축되고 데이터 전송을 시작

1. SYN 단계: 클라이언트는 서버에 클라이언트의 ISN을 담아 SYN을 보냅니다. ISN은 새로운 TCP 연결의 첫 번째 패킷에 할당된 임의 시퀸스 번호를 말하며 이는 장치마다 다를 수 있습니다.
2. SYN + ACK 단계: 서버는 클라이언트의 SYN을 수신하고 서버의 ISN을 보내며 승인번호로 클라이언트의 iSN + 1을 보냅니다
3. ACK 단계: 클라이언트는 서버의 iSN + 1한 값인 승인번호를 담아 ACK를 서버에 보냅니다.

SYN : 연결 요청 플래그
ACK: 응답 플래그
ISN: 초기 네트워크 연결을 할 때 할당된 32비트 고유 시퀸스 번호

**TCP 연결 해제 과정**
TCP가 연결 해제할 때는 4-웨이 핸드쉐이트가 발생

1. 먼저 클라이언트가 연결을 닫으려고 할 깨 FIN으로 설정된 세그먼틀르 보냅니다. 그리고ㅓ 클라이언트는 ㅡFIN_WAIT_1 상태로 들어가고 서버의 응답을 기다립니다
2. 서버는 클라이언트로 ACK라는 승인 세그먼트를 보냅니다, 그리고 CLOSE_WAIT 상태에 들어 갑니다, 클라이언트가 세그먼트를 받으면 FIN_WAIT_2 상태에 들어갑니다
3. 서버는 ACK를 보내고 일정 시간 이후에 클라이언트에 FIN이라는 세그먼트를 보냅니다
4. 클라이언트는 TIME_WAIT 상태가 되고 다시 서버로 ACK를 보내서 서버는 CLOSED 상태가 됩니다, 이후 클라이언트는 어느 정도의 시간을 대기한 후 연결이 닫히고 클라이언트와 서버의 모든 자원의 연결이 해제됩니다.

_TIME_WAIT에서 바로 닫지 않고 일정 시간 뒤에 닫는 이유_

1. 지연 패킷이 발생할 경우를 대비하기 위함
   - 패킷이 뒤늦게 도달하고 이를 처리하지 못한다면 데이터 무결성 문제가 발생
     ex) 전체 데이터가 100일 때 일부 데이터인 50만 들어오는 현상이 발생할 수도 있다
2. 두 장치가 연결이 닫혔는지 확인
   - 만약 LAST_ACK 상태에서 닫히게 되면 다시 새로운 연결을 하려고 할 떄 장치는 줄곧 LAST_ACK로 되어 있기 떄문에 접속 오류가 나타남

TIME_WAIT: 소켓이 바로 소멸되지 않고 일정 시간 유지되는 상태를 말하며 지연 패킷 등의 문제점을 해결하는 게 쓰인다.

데이터 무결성: 데이터의 정확성과 일관성을 유지하고 보증하는 것

### 인터넷 계층

- 장치로부터 받은 네트워크 패킷을 IP주소로 지정된 목적지로 전송하기 위해 사용되는 계층
- IP, ARP, ICMP
- 패킷을 수신해야 할 상대의 주소를 지정하여 데이터를 전달
- 상대방이 제대로 받았는지에 대해 보장하지 않은 비연결형적인 특징을 가짐

### 링크 계층

- 실질적으로 데이터를 저달하며 장치 간에 신호를 주고받는 규칙을 정하는 계층
- 전선, 광섬유, 무선
- 네트워크 접근 계층이라고도 함

물리 계층과 데이터 링크 계층으로 나누기도 함
**물리 계층**: 무선 LAN과 *유선 LAN*을 통해 0과 1로 이루어진 데이터를 보내는 계층
**데이터 링크 계층**: 이더넷 프레임을 통해 에러 확인, 흐름제어, 접근 제어를 담당하는 계층

#### 유선 LAN (IEEE 802.3)

- **유선 LAN**은 **IEEE 802.3** 표준을 따르는 **이더넷(Ethernet)** 사용
- **속도**, **케이블 유형**, **전송 방식**에 따라 다양한 형태의 이더넷이 존재

##### 전이중화 통신

- 송신과 수신을 **동시에** 수행하는 방식
- **송신로(TX)**와 **수신로(RX)**를 각각 분리하여 충돌(콜리전)이 발생하지 않음
- 현대의 고속 이더넷 은 거의 전이중 방식으로 통신

##### 반이중화 통신

- 이전에는 **반이중 통신**중 하나인 **CSMA/CD**를 사용
- 반이중은 **동시에 송수신할 수 없고**, 한 번에 한 방향으로만 데이터 전송 가능
- 이러한 환경에서 사용하는 프로토콜이
  - **CSMA**: 데이터를 보내기 전, 매체가 사용 중인지(캐리어 감지) 확인
  - **CD**: 전송 도중 충돌(콜리전)이 발생하면, 즉시 전송을 중단하고 **일정 시간 대기 후** 재전송
- 반이중 구간에서는 **송신로·수신로를 분리하지 않고** 하나의 경로를 공유하기에, 충돌에 대비해야 했음

- **과거**: 동축 케이블(10BASE2, 10BASE5) 또는 허브 연결 등으로 한 선을 공유 → **반이중 + CSMA/CD** 필수.
- **현재**: 스위치 기반의 포트별 **전이중** 환경 → **송신·수신 분리**로 충돌 제거, CSMA/CD 불필요.

#### 유선 LAN을 이루는 케이블

유선 LAN을 이루는 케이블로는 TP 케이블(트위스트 페어 케이블)과 광섬유 케이블이 대표

##### 트위스트 페어 케이블 (UTP, STP)

- 우리가 흔히 **LAN 케이블**이라고 부르는 케이블로, 내부에 **8가닥**의 구리선이 있으며, 이를 **2개씩 꼬아**(Twisted Pair) 외부 간섭을 줄임.
- **UTP(Unshielded Twisted Pair)**: 실드 처리가 없어 가볍고 저렴하지만 간섭에 약함.
- **STP(Shielded Twisted Pair)**: 케이블 내부에 금속 차폐(Shield)가 있어 간섭 방어에 강하지만, 굵고 비쌈.

##### 광섬유 케이블

- 내부가 **유리** 또는 **플라스틱** 섬유로 구성된 케이블.
- **레이저**나 **LED**로 **빛**을 쏘아 데이터를 전송하므로, **구리선 대비 훨씬 긴 거리**와 **고속** 전송이 가능.
- 일반적으로 **100Gbps** 이상의 대역폭을 지원할 수 있으며, **EMI(전자파 간섭)**가 전혀 없고 도청도 어려워 보안성이 뛰어남.
- 기본 원리는 광섬유 내부와 외부의 **굴절률** 차이를 이용해, 빛이 내부에서 **계속 반사**되며 전송되는 것.

#### 무선 LAN

##### 1. 반이중 통신

- **양쪽 장치가 서로 통신**할 수 있지만, **동시**에는 불가능하며 **한 번에 한 방향**만 전송 가능
- 한 쪽 장치가 **수신을 시작**하면, **전송**은 상대방이 먼저 끝날 때까지 기다려야 함
- 동시에 두 장치 이상이 전송 시 **충돌**이 발생하므로, 이를 **감지**하거나 **방지**하기 위한 매커니즘이 필요

##### 2. CSMA/CA

- 반이중 통신 방식 중 하나로, 충돌을 **사전에 방지**하는 프로토콜.
- 주요 동작 순서:
  1. **채널 상태 감지**: 현재 채널이 사용 중이라면 대기, 유휴 상태가 될 때까지 기다린 후 사용 가능한 채널을 찾음.
  2. **IFS 대기**: 프레임과 프레임 사이의 간격(IFS, Inter-Frame Spacing)만큼 기다림.<br>∙ IFS 시간은 우선순위 정의에도 사용 (IFS가 짧을수록 우선순위 높음).
  3. **랜덤 백오프**: 정해진 범위 내에서 **랜덤 시간**만큼 추가로 대기 후 프레임 전송.<br>∙ 전송 후 **ACK** 수신 여부 확인.<br>∙ ACK가 오면 전송 성공, **ACK가 없으면 재전송(K = K + 1)**.<br>∙ **K > Kmax**가 되면 전송 포기.

##### 무선 LAN을 이루는 주파수

- 무선 LAN은 무선 신호 전달 방식을 이용하여 2대 이상의 장치를 연결하는 기술
- 비유도 매체인 공기에 주파수를 쏘아 무선 통신망을 구축하는데, 주파수 대역은 2.4GHz 대역 또는 5GHz 대역 중 하나를 써서 구축
  - 2.4GHz: 장애물에 강한 특성을 가지고 있지만 전자레인지, 무선 등 전파 간섭이 일어나는 경우가 많음
  - 5GHz: 사용할 수 있는 채널 수도 많고 동시에 사용할 수 있기 때문에 상대적으로 깨끗한 전파 환경을 구축할 수 있음
- 그렇기 때문에 보통 5GHz 대역을 사용

**무선 LAN(WLAN) 및 서비스 집합(BSS, ESS) 정리**

|                항목                | 설명                                                                                                                                                                                                                 | 특징/비고                                                                                                                                                       |
| :--------------------------------: | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|             **Wi-Fi**              | - 무선 LAN 기술 중 하나로, 주파수를 사용해 전자기기들이 **무선으로 LAN에 연결**할 수 있게 함.<br>- 흔히 쓰는 **공유기(AP)**를 통해 유선 LAN 신호를 **무선 신호**로 변환하여, 해당 신호 범위 내에서 인터넷 사용 가능. | - 무선 LAN 기술은 Wi-Fi 외에도 **지그비(ZigBee)**, **블루투스(Bluetooth)** 등이 존재.<br>- 보통 **2.4GHz** 또는 **5GHz** 대역 사용.                             |
|  **BSS** <br>(Basic Service Set)   | - **하나의 AP**(Access Point)를 중심으로 구성된 **기본 무선 서비스 영역**.<br>- 동일 BSS 내 AP와만 연결되므로, **이동 시** 다른 AP로 원활히 **로밍(이동)**이 어려움.<br>- 일반적으로 소규모/단일 AP 환경에서 사용.   | - BSS에 속한 기기는 **동일 AP** 범위 안에서만 무선 통신.<br>- BSS 간 연결(로밍)이 필요 없는 경우에 단순하게 구성 가능.                                          |
| **ESS** <br>(Extended Service Set) | - **하나 이상의 BSS가 상호 연결**(분산 시스템 등으로)되어 **확장**된 무선 네트워크.<br>- 여러 AP가 상호 연동되어, 사용자가 장소를 **이동**해도 **중단 없이** 네트워크에 연결 가능.                                   | - 건물이나 캠퍼스와 같이 **넓은 지역**을 커버할 때 활용.<br>- **장거리 무선 통신**, 로밍, **이동성** 높음.<br>- 흔히 기업·학교·대형 건물 Wi-Fi 환경에서 사용됨. |

#### 이더넷 프레임

데이터 링크 계층은 이더넷 프레임을 통해 전달받은 데이터의 에러를 검출하고 캡슐화함

- Preamble: 이더넷 프레임이 시작됨을 알림
- SFD(Start Frame Delimiter): 다음 바이트로부터 MAC 주소 필드가 시작됨을 알림
- DMAC, SMAC: 수신, 송신 MAC 주소
- EtherType: 데이터 계층 위의 계층인 IP 프로토콜을 정의 (ex. IPv4, IPv6)
- Payload: 전달받은 데이터
- CRC: 에러 확인 비트

MAC주소: 컴퓨터같은 장치에는 네트워크에 연결하기 위한 장치가 있는 이를 구별하기 위한 식별번호

### 계층 간 데이터 송수신 과정

네트워크에서 **한 컴퓨터**(클라이언트)에서 **다른 컴퓨터**(서버)로 데이터를 요청하고 응답을 받는 과정은 **캡슐화(Encapsulation)**와 **비캡슐화(Decapsulation)**를 통해 이루어짐

#### 1. 캡슐화(Encapsulation)

- **상위 계층**에서 생성된 데이터에 **하위 계층**으로 내려갈 때, 해당 계층의 **헤더(Header)** 혹은 **트레일러(Trailer)** 등을 **덧붙여** 전송하는 과정.
- 각 계층에서는 **상위 계층 PDU**(Protocol Data Unit)를 **자신의 PDU 형태**로 바꾸며, 필요한 정보를 **헤더**로 추가.

1. **애플리케이션 계층**: **메시지** 형태의 데이터 생성
2. **전송 계층**: 메시지를 **세그먼트(TCP)** 또는 **데이터그램(UDP)** 형태로 바꾸고, **TCP/UDP 헤더** 추가
3. **네트워크 계층**: 세그먼트를 **패킷**으로 바꾸고, **IP 헤더** 추가
4. **링크 계층**: 패킷을 **프레임** 형태로 만들고, **프레임 헤더/트레일러** 추가
5. 물리 계층: 프레임을 **비트(신호)**로 변환하여 전송

#### 2. 비캡슐화(Decapsulation)

- **하위 계층**에서 **상위 계층**으로 올라오면서, 각 계층에서 **자신의 헤더/트레일러**를 제거하고 상위 계층에 전달하는 과정.
- 도착지 컴퓨터(서버)에서 **링크 계층**부터 시작하여 **네트워크/전송/애플리케이션 계층** 순으로 헤더를 제거하며 최종 **메시지** 형태를 얻음.

1. **링크 계층**: 받은 신호를 **프레임**으로 인식, **프레임 헤더/트레일러** 제거 → **패킷** 추출
2. **네트워크 계층**: **IP 헤더** 제거 → **세그먼트/데이터그램** 추출
3. **전송 계층**: **TCP/UDP 헤더** 제거 → **메시지** 추출
4. **애플리케이션 계층**: 최종적으로 **메시지**(데이터)를 해석하여 사용자에게 전달

## PDU

- 네트워크의 어떠한 계층에서 계층으로 데이터가 전달될 때 한 덩어리의 단위
- 제어 관련 정보들이 포함된 헤더, 데이터를 의미하는 페이로드로 구성
- 계층마다 부르는 명칭이 다름
  - 애플리케이션 계층 - 메시지
  - 전송 계층 - 세그먼트 , 데이터그램
  - 인터넷 계층 - 패킷
  - 링크 계층 - 프레임
- PDU중 비트로 송수신하는 것이 젤 빠르고, 효율성이 높다
  - 애플리케이션 계층은 헤더에 authorization 값을 넣는 확장을 위해 **문자열 기반**으로 송수신 함

# 네트워크 기기

여러 개의 네트워크 기기를 기반으로 구축

## 네트워크 기기의 처리 범위

- 네트워크 기기는 계층별로 처리 범위를 나눌 수 있음
  - 애플리케이션 계층: L7 스위치
  - 인터넷 계층: 라우터, L3 스위치
  - 데이터 링크 계층: L2 스위치, 브리지
  - 물리 계층 : NIC, 리피터, AP
- 상위 계층을 처리하는 기기는 하위 계층을 처리할 수 있지만 그 반대는 불가

## 애플리케이션 계층을 처리하는 기기

### L7 스위치

#### 1. 스위치(Switch) 기본 개념

- 여러 장비를 연결하고, **데이터 통신**을 **중재**하는 네트워크 장비
- 목적지가 연결된 포트로만 **전기 신호**를 보내 **데이터를 전송**함

#### 2. L7 스위치 (로드 밸런서)

- **서버 부하 분산**에 특화된 기기
- 클라이언트 요청을 **뒤쪽의 여러 서버**로 **분산**시켜, 시스템이 처리할 수 있는 트래픽을 **효율적으로 증가**
- **URL, 서버, 캐시, 쿠키** 등을 기준으로 트래픽을 분산
- **외부로부터 유입되는 악성 트래픽**(바이러스, 불필요 데이터 등)을 걸러내고, **응용 프로그램 수준**의 트래픽 모니터링 가능
- **헬스 체크(Health Check)**를 통해 장애가 발생한 서버는 분산 대상에서 제외

### 2.1. L4 스위치와 L7 스위치 차이

|          구분           |                                L4 스위치                                 |                     L7 스위치                      |
| :---------------------: | :----------------------------------------------------------------------: | :------------------------------------------------: |
|        **계층**         |                              **전송 계층**                               |                   **응용 계층**                    |
|      **분산 기준**      |                         IP 주소 & 포트 (TCP/UDP)                         |      URL, HTTP 헤더, 쿠키 등 **메시지 내용**       |
|      **사용 예시**      | - 스트리밍 관련 서비스에서는 **불가** <br> - 기본 TCP/UDP 기반 단순 분산 | - HTTP 기반 웹 서비스 <br> - 세부 콘텐츠 기반 분산 |
| **AWS 클라우드 서비스** |                     **NLB** (Network Load Balancer)                      |        **ALB** (Application Load Balancer)         |

### 3. 헬스 체크(Health Check)

- **L4, L7 모두 적용** 가능
- 서버의 정상 여부를 **주기적으로 확인**:
  1. 설정된 **간격**과 **재시도 횟수**에 따라 **서버에 요청** 전송
  2. 응답이 정상(예: TCP 3-way handshake 성공, HTTP 200 OK 등)이면 **정상 서버**로 판별
  3. 실패 시 재시도 후 계속 실패하면 **비정상 서버**로 분류 → 트래픽 분산 대상에서 제외
- **헬스 체크** 자체도 **서버 부하**를 고려해 적절히 설정해야 함

### 4. 로드밸런서의 서버 이중화

- **서버 이중화** = 서비스 **안정성** 향상을 위해 2대 이상의 서버를 구성
- 로드밸런서는 여러 서버를 묶어 **가상 IP(VIP)**를 제공하며, 이를 통해 **단일 서비스**로 보이게 함
- 특정 서버에 **장애**가 발생해도, 나머지 서버가 **연속성**을 유지 → 사용자 입장에선 **무중단 서비스** 가능

## 인터넷 계층을 처리하는 기기

### 라우터(Router)

1. **네트워크 연결 및 분할**

   - 여러 개의 **서브넷**(네트워크)을 **연결**
   - **하나의 네트워크**를 여러 개로 **분할**하여 **트래픽을 효율적으로 관리**

2. **최적의 경로 탐색**

   - 다른 **네트워크**에 존재하는 장치끼리 데이터를 주고받을 때, **패킷 소모**를 최소화하기 위해 **최적의 경로**를 찾음
   - 이를 위해 **라우팅 프로토콜**(RIP, OSPF, BGP 등)을 사용해 **라우팅 테이블**을 구성하고, **최소 경로**로 데이터(패킷)를 **전달**함

3. **라우팅(Routing)**
   - **패킷**이 도달해야 할 **목적지**에 따라 가장 **효율적인 경로**로 **포워딩**(전달)하는 역할
   - 라우터는 IP 주소 정보를 기반으로 **네트워크 간** 패킷 전달을 관리함

### L3 스위치

- L2 스위치의 기능과 라우팅 기능을 갖춘 장비
- L3스위치 = 라우터 라고 해도 무방
- 라우터는 소프트웨어 기반의 라우팅, **하드웨어 기반**의 라우팅으로 나눠짐
  - 하드웨어 기반의 라우팅을 담당하는 장치 = L3스위치

|    구분     |    L2 스위치    |   L3 스위치   |
| :---------: | :-------------: | :-----------: |
| 참조 테이블 | MAC 주소 테이블 | 라우팅 테이블 |
|  참조 PDU   |  이너넥 프레임  |    IP 패킷    |
|  참조 주소  |    MAC 주소     |    IP주소     |

## 데이터 링크 계층을 처리하는 기기

### L2 스위치

- 장치들의 MAC주소를 MAC 주소 테이블을 통해 관리
- 연결된 장치로부터 패킷이 왔을 때 패킷 전송 담당
- 패킷의 MAC주소를 읽어 스위칭하는 역할
  - 목적지가 MAC 주소 테이블에 없다면 전체 포트에 전달, MAC 주소테이블의 주소를 일정 시간 이후 삭제할 수 있음

### 브리지

- 두 개의 근거리 통신망을 상호 접속할 수 있도록 하는 통신망 연결 장치
- 포트와 포트 사이의 다리 역할
- 장치에서 받아온 MAC주소를 MAC주소 테이블로 관리
- 통신망 범위를 확장하고 서로 다른 LAN 등으로 이루어진 하나의 통신망을 구축할 때 쓰임

## 물리 계층을 처리하는 기기

### NIC (네트워크 인터페이스 카드)

- 컴퓨터 내에 설치하는 확장 카드
- LAN카드라고 함
- 2대 이상의 컴퓨터 네트워크를 구성하는 데 사용
- 네트워크와 빠른 속도로 데이터를 송수신할 수 있도록 함
- 각 LAN 카드에는 고유의 식별번호인 MAC 주소가 있음

### 리피터

- 들어오는 약해진 신호 정도를 증폭해여 다른 쪽으로 전달하는 장치
  - 패킷이 더 멀리 갈 수 있게함
  - 지금은 광케이블이 보급됨에 따라 현재는 잘 쓰이지 않는 장치

### AP

- 패킷을 복사하는 기기
- AP에 유선 LAN을 연결한 후 다른 장치에서 무선 LAN을 사용하여 무선 네트워크 연결 할 수 있음

# IP주소

## ARP

| IP 주소를 기반으로 **MAC 주소**를 찾는 프로토콜, **IP와 MAC 주소 간**의 연결 고리 역할을 함

- 논리적 주소 -> ARP -> 물리적 주소
- 물리적 주소 -> RARP -> 논리적 주소

- 브로드 캐스트: 송신 호스트가 전송한 데이터가 네트워에 연결된 모든 호스트에 전송되는 방식
- 유니캐스트: 고유 주소로 식별된 하나의 네트워크 목적지에 1:1로 데이터를 전송하는 방식

## 홉바이홉 통신

| IP 주소를 통해 통신하는 과정 = 홉바이홉 통신

- **홉(Hop)**: 영어로 ‘깡충 뛰다’를 의미하며, 네트워크에서는 패킷이 **라우터** 같은 중간 노드를 **하나씩 건너가는 과정**을 비유적으로 표현.
- **홉바이홉 통신**: IP 주소를 사용하여 **각 라우터(라우팅 장치)**를 차례대로 거치면서 목적지까지 패킷을 전달하는 방식

### 통신 과정

1. **라우팅 테이블 확인**
   - 각 라우터는 **라우팅 테이블**을 참조하여, **다음 목적지 IP**(Next Hop)를 결정
2. **패킷 전달**
   - 정해진 **Next Hop**(다음 라우터)으로 **패킷**을 전송
3. **반복**
   - 다음 라우터에서도 동일한 과정을 거쳐, **최종 목적지**(Destination IP)에 도달할 때까지 계속 전달

### 라우팅 테이블

- 송신지에서 수신지까지 도달하기 위해 사용되며 라우터에 들어가 있는 목적지 정보들과 그 목적지로 가기 위한 방법이 들어 있는 리스트
- 게이트웨어와 모든 목적지에 대해 해당 목적지에 도달하기 위해 거쳐야 할 다음 라우터 정보를 가지고 있음

### 게이트웨이

- 서로 다른 통신망, 프로토콜을 사용하는 네트워크 간의 통신을 가능하게 하는 관문 역할을 하는 컴퓨터나 소프트웨어를 두루 일컫는 용어
- 사용자는 인터넷에 접속하기 위해 수많은 톨 케이트인 케이트웨이를 걸쳐야 하며 게이트웨은느 서로 다른 네트우크 상의 통신 프로토콜을 변환해즌 역항르 하기도 합니다

게이트웨이를 확인하는 방법은 라우틴 테이블을 통해 볼 수 있으며 라우팅 테이블은 윈도우의 명령 프로프트에서 명령어 실행하여 확인 가능

## IP 주소 체계

# HTTP

## HTTP/1.0

## HTTP/1.1

## HTTP/2

## HTTPS

## HTTP/3
